---
title: "Severe Weather Events of Greatest Impact"
author: "jmtaysom"
date: "April 23, 2015"
output: html_document
---
## Severe Weather Events of Greatest Impact
Synopsis: This project examines NOAA's storm database in an attempt to analyze
the storms and identify those with the greatest impact. There are two categories
that will be the main focus: greatest property damage and most harmful to human
health.

## Data Processing
```{r}
library(ggplot2)
library(reshape2)
library(plyr)
```

```{r, cache=TRUE}
url = 'https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2'
zip = 'Storm_Data.csv.bz2'
download.file(url, zip, method='curl')
rm(url)
storm <- read.csv(bzfile(zip), nrows=5000)
rm(zip)
```
remap the values of the damage levels to numeric and calculate the total damage
```{r}
storm$PROPDMGEXP <-revalue(storm$PROPDMGEXP, c("K"="1000", "M"="1000000"))# "B"=1000000000))
storm$PROPDMGEXP <- sub("^$", "1", storm$PROPDMGEXP)
storm$PROPDMG <- storm$PROPDMG * as.numeric(storm$PROPDMGEXP)
View(storm)
```

Sumarize the injuries and fatalities by event type
```{r}
human.damage <- ddply(storm, "EVTYPE", summarize, injuries = sum(INJURIES), fatalities = sum(FATALITIES))
hd.m <- melt(human.damage, id.vars='EVTYPE')

```

Sumarize the total damage by event type
```{r}
prop.damage <- ddply(storm, "EVTYPE", summarize, propdmg = sum(PROPDMG))
```
##Results

```{r}
ggplot(hd.m, aes(x=EVTYPE, y=value,fill=variable)) + geom_bar(stat='identity')
ggplot(prop.damage, aes(x=EVTYPE, y=propdmg)) + geom_bar(stat='identity')
```


